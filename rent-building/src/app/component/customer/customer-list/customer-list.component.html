
<div class="col-md-5 mt-5">
    <div class="input-group">
      <input type="text" class="form-control search-input" placeholder="Tìm kiếm thông tin khách hàng" [(ngModel)]="search">
      <button type="button" class="btn btn-secondary search-button"><strong><i
        class="fa fa-search text-danger"></i></strong></button>
    </div>

</div>

<h3 class="text-muted text-center mb-3 mt-5">DANH SÁCH KHÁCH HÀNG</h3>
<form action=""  [formGroup]="formAddNewCustomer" >
  <button class="btn btn-success px-4 py-2" (click)="checkAddCustomer()">
    <i class="material-icons"data-toggle="tooltip" title="Thêm">playlist_add</i>
  </button>
<table class="table bg-light text-center table-bordered table-striped">

  <thead class="thead-dark">
  <tr  class="text-muted">
    <th>STT</th>
    <th>Họ Tên (<span style="color: red">*</span>) </th>
    <th>CMND (<span style="color: red">*</span>)</th>
    <th>Email (<span style="color: red">*</span>)</th>
    <th>Số Điện Thoại (<span style="color: red">*</span>)</th>
    <th>Ngày Sinh</th>
    <th>Địa Chỉ (<span style="color: red">*</span>)</th>
    <th>Website</th>
    <th>Công Ty (<span style="color: red">*</span>)</th>
    <th>Tên Mặt Bằng </th>
    <th>Đang thuê</th>
    <th colspan="2"></th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let customer of customers |filter : search |paginate: {  itemsPerPage: 5, currentPage: page,id:'listing_pagination' } ;let i  = index">
    <input type="text" hidden value="{{customer.id}}" formControlName="id">
    <td> {{(i+1)+(page-1)*5}}</td>
    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.name}}</td>
    <td *ngIf="checkEdit  && customer.id===flag ">
      <input type="text" class="form-control" formControlName="name" value="{{customer.name}}">
    </td>

    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.idCard}}</td>
    <td *ngIf="checkEdit && customer.id===flag ">
      <input type="text"
             class="form-control"
             formControlName="idCard"
             value="{{customer.idCard}}">
    </td>

    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.email}}</td>
    <td *ngIf="checkEdit && customer.id===flag ">
      <input type="text"
             class="form-control"
             formControlName="email"
             value="{{customer.email}}">
    </td>


    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.phone}}</td>
    <td *ngIf="checkEdit && customer.id===flag ">
      <input type="text"
             class="form-control"
             formControlName="phone"
             value="{{customer.phone}}">
    </td>


    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.birthday | date:'dd/MM/yyyy'}}</td>
    <td *ngIf="checkEdit && customer.id===flag">

        <input   class="form-control" formControlName="birthday" placeholder="Choose a date" matInput
               [matDatepicker]="picker1" value="{{customer.birthday}}">

      <mat-datepicker-toggle  matSuffix [for]="picker1"></mat-datepicker-toggle>
      <mat-datepicker #picker1 startView="year" [startAt]="startDate"></mat-datepicker>
    </td>


    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.address}}</td>
    <td *ngIf="checkEdit && customer.id===flag">
      <input type="text"
             class="form-control"
             formControlName="address"
             value="{{customer.address}}">
    </td>

    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.website}}</td>
    <td *ngIf="checkEdit && customer.id===flag">
      <input type="text" class="form-control"
             formControlName="website"
             value="{{customer.website}}">
    </td>

    <td *ngIf="!checkEdit || customer.id!==flag">{{customer.nameCompany}}</td>
    <td *ngIf="checkEdit && customer.id===flag">
      <input type="text" class="form-control"
             formControlName="nameCompany"
             value="{{customer.nameCompany}}">
    </td>



    <td >
    <ng-container *ngFor="let contract of contracts" >
      <p *ngIf="contract.customer.id == customer.id">{{contract.ground.codeGround}}</p>

    </ng-container>
    </td>

    <td>
    <ng-container *ngFor="let contract of contracts" >
    <p> <input *ngIf="contract.customer.id == customer.id" type="checkbox" [checked]="contract.statusContract" disabled></p>

    </ng-container>
    </td>


    <td>
      <button *ngIf="!checkEdit|| customer.id!==flag" class="btn btn-warning ml-3"
              (click)="checkEditCustomer(customer.id)"><i class="material-icons" data-toggle="tooltip" title="Sửa">&#xE254;</i>
      </button>
      <button *ngIf="checkEdit && customer.id===flag" class="btn btn-primary ml-3" type="button"
              (click)="editCustomer()"><i class="material-icons" data-toggle="tooltip" title="Lưu">done</i>
      </button>

    </td>

    <td>
      <button *ngIf="!checkEdit|| customer.id!==flag" class="btn btn-danger ml-3"
              (click)="openDialogDelete(customer.id)"><i class="material-icons" data-toggle="tooltip" title="Xóa">&#xE872;</i>
      </button>
      <button *ngIf="checkEdit && customer.id===flag" class="btn btn-danger ml-3" type="button"
              (click)="resetCustomer()"><i class="material-icons" data-toggle="tooltip" title="Hủy">&#xe950;</i>
      </button>
    </td>
  </tr>


  <!--      add customer-->


  <tr *ngIf="checkAdd" style="border-top: 5px solid slateblue">
    <td></td>
    <td>
      <input type="text" class="form-control" formControlName="name">
      <p
        *ngIf="formAddNewCustomer.controls.name.errors?.required && formAddNewCustomer.controls.name.touched"
        class="text-danger">Vui lòng nhập tên !!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="idCard">
      <p
        *ngIf="formAddNewCustomer.controls.idCard.errors?.required && formAddNewCustomer.controls.idCard.touched"
        class="text-danger">Vui lòng nhập CMND!!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="email">
      <p
        *ngIf="formAddNewCustomer.controls.email.errors?.required && formAddNewCustomer.controls.email.touched"
        class="text-danger">Vui lòng nhập email!!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="phone">
      <p
        *ngIf="formAddNewCustomer.controls.phone.errors?.required && formAddNewCustomer.controls.phone.touched"
        class="text-danger">Vui lòng nhập phone!!!</p>
    </td>
    <td>

        <input class="form-control" formControlName="birthday" placeholder="Choose a date" matInput
               [matDatepicker]="picker1">

      <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
      <mat-datepicker #picker1 startView="year" [startAt]="startDate"></mat-datepicker>
      <p
        *ngIf="formAddNewCustomer.controls.birthday.errors?.required && formAddNewCustomer.controls.birthday.touched"
        class="text-danger">Vui lòng nhập birthday!!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="address">
      <p
        *ngIf="formAddNewCustomer.controls.address.errors?.required && formAddNewCustomer.controls.address.touched"
        class="text-danger">Vui lòng nhập address!!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="website">
      <p
        *ngIf="formAddNewCustomer.controls.website.errors?.required && formAddNewCustomer.controls.website.touched"
        class="text-danger">Vui lòng nhập website!!!</p>
    </td>
    <td>
      <input type="text" class="form-control" formControlName="nameCompany">
      <p
        *ngIf="formAddNewCustomer.controls.nameCompany.errors?.required && formAddNewCustomer.controls.nameCompany.touched"
        class="text-danger">Vui lòng nhập nameCompany!!!</p>
    </td>

    <td colspan="4">
      <button  class="button btn btn-warning" (click)="addNewCustomer()" >Xác Nhận</button>
      <button class="button btn btn-danger ml-5" (click)="cancelAdd()">Hủy</button>

    </td>
  </tr>

  </tbody>

</table>

</form>
<!--    pagination-->
<pagination-controls class="pagination justify-content-center" id="listing_pagination" (pageChange)="page = $event" previousLabel="Trang trước"
                     nextLabel="Trang sau">

</pagination-controls>





